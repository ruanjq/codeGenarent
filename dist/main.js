$(function(){var e=$(".J_pc").length>0,t=e?1:parseFloat($("html").css("fontSize")),n={rotate:0,top:0,left:0,width:75,height:75,borderRadius:0,link:""},o="",a=new Clipboard("#J_copy_code");a.on("success",function(e){J("代码复制成功!!!")}),a.on("error",function(e){J("代码复制失败")});var r=function(e){$("#J_add_link").click(function(){if(""!=o)if("loading"!=o)if("error"!=o){var t=!0;""==$("#J_img_src").val()?(t=!1,$("#J_img_src").addClass("error")):(t=!0,$("#J_img_src").removeClass("error")),""==$("#J_link").val()?(t=!1,$("#J_link").addClass("error")):(t=!0,$("#J_link").removeClass("error")),t&&"function"==typeof e&&e(),""!=$("#J_img_src").val()?""!=$("#J_link").val()||J("请输入跳转链接地址!"):J("请输入图片地址!")}else J("图片加载失败,请重新输入!");else J("图片加载中,请稍后!");else J("请输入图片地址!")}),$("#J_img_src").blur(function(){""==$(this).val()?$(this).addClass("error"):$(this).removeClass("error")}),$("#J_link").blur(function(){""==$(this).val()?$(this).addClass("error"):$(this).removeClass("error")})},i=function(){function e(e){n();var t=new Image,o=e+"?t="+(new Date).getTime();t.src=o,t.onload=function(){$(".J_banner").attr("src",o).show()},t.onerror=function(){a("load")}}function t(){o="success",$("#draggable").show(),l(),s(),$("#J_loading_panel").hide(),$(".J_disabled").removeClass("disabled")}function n(){o="loading",$("#J_loading_txt").hide(),$("#J_loading_panel").show(),$(".J_banner").hide(),$(".J_disabled").addClass("disabled"),$("#draggable").hide(),g()}function a(e){g(),o="error",$(".J_banner").hide(),$("#draggable").hide(),$("#J_loading_panel").hide(),"input"==e?(J("请输入正确图片地址!"),$("#J_loading_txt").show().html("请输入正确图片地址!")):(J("图片加载失败!"),$("#J_loading_txt").show().html("图片加载失败!"))}var r=$("#J_img_src").val();$("#J_img_src").blur(function(){var t=$(this).val();t!=$(".J_banner").attr("src")&&(""==t||null==t.match("http")&&null==t.match("https")?a("input"):e(t))}),""!=r&&e(r),$("#J_img_wrap .J_banner").load(function(){t()})},l=function(){$("#draggable").julyuiDrag({isLimit:!0,position:"absolute",scroll:!1,onStop:function(e){$(this).attr("PosX",e.left).attr("PosY",e.top),n.left=e.left,n.top=e.top}})},s=function(){$("#draggable").julyuiDragResize({onStop:function(e){l(),n.left=e.left,n.top=e.top,n.width=e.width,n.height=e.height}})},c=function(){$("input[name=shape]").on("change",function(){var e=$(this).val();n.borderRadius=1==e?0:"50%",$("#draggable").css({borderRadius:n.borderRadius})})},d=function(){$("#rangeRotate").on("change mousemove touchmove",function(){var e=$(this).val();$("#J_rotate").html("("+e+")"),n.rotate=e,$("#draggable").css({transform:"rotate("+e+"deg)"})}),$("#J_reset").click(function(){$("#J_rotate").html("(0)"),n.rotate=0,$("#rangeRotate").val(0),$("#draggable").css({transform:"rotate(0deg)"})})},_=function(n){var o=(n.top/t).toFixed(6),a=(n.left/t).toFixed(6),r=(n.height/t).toFixed(6),i=(n.width/t).toFixed(6),l=(new Date).getTime();if(e){o=parseInt(o),a=parseInt(a),r=parseInt(r),i=parseInt(i),l=parseInt(l);var s="";return $("#J_blank_forward").prop("checked")&&(s="target='_blank'"),"<a "+s+" class='r-link-block J_link"+l+"' data-id="+l+" style='display:block;transform:rotate("+n.rotate+"deg);position:absolute;left:"+a+"px;top:"+o+"px;width:"+i+"px;height:"+r+"px;z-index:2;border-radius:"+n.borderRadius+"' href='"+n.link+"'></a>"}return"<a class='r-link-block J_link"+l+"' data-id="+l+" style='display:block;transform:rotate("+n.rotate+"deg);position:absolute;left:"+a+"rem;top:"+o+"rem;width:"+i+"rem;height:"+r+"rem;z-index:2;border-radius:"+n.borderRadius+"' href='"+n.link+"'></a>"},u=function(e){$(".J_banner_link_code").append(_(e)),p()},f=function(){$(document).on("click",".J_banner_link_code .r-link-block",function(e){e.stopPropagation(),e.preventDefault();var t=$(this).data("id");return $(".J_link"+t).remove(),p(),!1})},p=function(){if(0==$("#J_code .r-link-block").length)$("#J_copy_code").attr("data-clipboard-text","");else{var e=$("#J_code").html();$("#J_copy_code").attr("data-clipboard-text",e)}},g=function(){$(".r-link-block").remove(),$("#J_copy_code").attr("data-clipboard-text","")},m=function(){},h=function(){$(".J_app").click(function(){$("#J_app_list").addClass("leave")}),$(".J_close").click(function(){$(".J_article").removeClass("enter").addClass("leave")}),$(".J_read").click(function(){$(".J_article").removeClass("leave").addClass("enter")}),$(".J_close_tool").on("click",function(){$(".J_tool_wrap").removeClass("enter").addClass("leave"),$(".J_tool_panpel_btn").removeClass("enter").addClass("leave")}),$(".J_tool_panpel_btn").on("click",function(){$(".J_tool_wrap").removeClass("leave").addClass("enter"),$(".J_tool_panpel_btn").removeClass("leave").addClass("enter")})},J=function(e){var t=$('<div class="msg-content J_msg_content"><p class="J_msg msg">'+e+"</p> </div>");$("body").append(t),setTimeout(function(){t.addClass("enter")},10),setTimeout(function(){t.removeClass("enter"),setTimeout(function(){t.remove()},800)},2e3)},v=function(){0==$(".J_pc").length&&$(window).on("resize",function(){setTimeout(function(){t=parseFloat($("html").css("fontSize"))},400)})},b=function(){$("#J_copy_code").click(function(){""!=$(this).attr("data-clipboard-text")&&0!=$("#J_code .r-link-block").length||J("至少添加一个跳转链接")})};(function(){var e=document.getElementById("J_main_wrap");$(window).scroll(function(t){e.getBoundingClientRect().top<=-75?$("#J_form_panel").addClass("fixed-form-panel"):$("#J_form_panel").removeClass("fixed-form-panel")})})(),d(),c(),i(),r(function(){n.link=$("#J_link").val(),console.log(t),u(n)}),m(),f(),h(),b(),v()});