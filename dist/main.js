$(function(){var e=$(".J_pc").length>0,t=e?1:37.5,o={rotate:0,top:0,left:0,width:75,height:75,borderRadius:0,link:""},n="",a=new Clipboard("#J_copy_code");a.on("success",function(e){J("代码复制成功!!!")}),a.on("error",function(e){J("代码复制失败")});var r=function(e){$("#J_add_link").click(function(){if(""!=n)if("loading"!=n)if("error"!=n){var t=!0;""==$("#J_img_src").val()?(t=!1,$("#J_img_src").addClass("error")):(t=!0,$("#J_img_src").removeClass("error")),""==$("#J_link").val()?(t=!1,$("#J_link").addClass("error")):(t=!0,$("#J_link").removeClass("error")),t&&"function"==typeof e&&e(),""!=$("#J_img_src").val()?""!=$("#J_link").val()||J("请输入跳转链接地址!"):J("请输入图片地址!")}else J("图片加载失败,请重新输入!");else J("图片加载中,请稍后!");else J("请输入图片地址!")}),$("#J_img_src").blur(function(){""==$(this).val()?$(this).addClass("error"):$(this).removeClass("error")}),$("#J_link").blur(function(){""==$(this).val()?$(this).addClass("error"):$(this).removeClass("error")})},i=function(){function e(e){o();var t=new Image(e);t.src=e,t.onload=function(){$(".J_banner").attr("src",e).show()},t.onerror=function(){a("load")}}function t(){n="success",$("#draggable").show(),l(),s(),$("#J_loading_panel").hide(),$(".J_disabled").removeClass("disabled")}function o(){n="loading",$("#J_loading_txt").hide(),$("#J_loading_panel").show(),$(".J_banner").hide(),$(".J_disabled").addClass("disabled"),$("#draggable").hide(),g()}function a(e){g(),n="error",$(".J_banner").hide(),$("#draggable").hide(),$("#J_loading_panel").hide(),"input"==e?(J("请输入正确图片地址!"),$("#J_loading_txt").show().html("请输入正确图片地址!")):(J("图片加载失败!"),$("#J_loading_txt").show().html("图片加载失败!"))}var r=$("#J_img_src").val();$("#J_img_src").blur(function(){var t=$(this).val();t!=$(".J_banner").attr("src")&&(""==t||null==t.match("http")&&null==t.match("https")?a("input"):e(t))}),""!=r&&e(r),$("#J_img_wrap .J_banner").load(function(){t()})},l=function(){$("#draggable").julyuiDrag({isLimit:!0,position:"absolute",scroll:!1,onStop:function(e){$(this).attr("PosX",e.left).attr("PosY",e.top),o.left=e.left,o.top=e.top}})},s=function(){$("#draggable").julyuiDragResize({onStop:function(e){l(),o.left=e.left,o.top=e.top,o.width=e.width,o.height=e.height}})},d=function(){$("input[name=shape]").on("change",function(){var e=$(this).val();o.borderRadius=1==e?0:"50%",$("#draggable").css({borderRadius:o.borderRadius})})},c=function(){$("#rangeRotate").on("change mousemove touchmove",function(){var e=$(this).val();$("#J_rotate").html("("+e+")"),o.rotate=e,$("#draggable").css({transform:"rotate("+e+"deg)"})}),$("#J_reset").click(function(){$("#J_rotate").html("(0)"),o.rotate=0,$("#rangeRotate").val(0),$("#draggable").css({transform:"rotate(0deg)"})})},_=function(o){var n=(o.top/t).toFixed(6),a=(o.left/t).toFixed(6),r=(o.height/t).toFixed(6),i=(o.width/t).toFixed(6),l=(new Date).getTime();if(e){n=parseInt(n),a=parseInt(a),r=parseInt(r),i=parseInt(i),l=parseInt(l);var s="";return $("#J_blank_forward").prop("checked")&&(s="target='_blank'"),"<a "+s+" class='r-link-block J_link"+l+"' data-id="+l+" style='display:block;transform:rotate("+o.rotate+"deg);position:absolute;left:"+a+"px;top:"+n+"px;width:"+i+"px;height:"+r+"px;z-index:2;border-radius:"+o.borderRadius+"' href='"+o.link+"'></a>"}return"<a class='r-link-block J_link"+l+"' data-id="+l+" style='display:block;transform:rotate("+o.rotate+"deg);position:absolute;left:"+a+"rem;top:"+n+"rem;width:"+i+"rem;height:"+r+"rem;z-index:2;border-radius:"+o.borderRadius+"' href='"+o.link+"'></a>"},u=function(e){$(".J_banner_link_code").append(_(e)),p()},f=function(){$(document).on("click",".J_banner_link_code .r-link-block",function(e){e.stopPropagation(),e.preventDefault();var t=$(this).data("id");return $(".J_link"+t).remove(),p(),!1})},p=function(){if(0==$("#J_code .r-link-block").length)$("#J_copy_code").attr("data-clipboard-text","");else{var e=$("#J_code").html();$("#J_copy_code").attr("data-clipboard-text",e)}},g=function(){$(".r-link-block").remove(),$("#J_copy_code").attr("data-clipboard-text","")},h=function(){},m=function(){$(".J_app").click(function(){t=$(this).data("size"),$("html").css("fontSize",t),$("#J_app_list").addClass("leave"),localStorage.fontSize=t}),$(".J_close").click(function(){$(".J_article").removeClass("enter").addClass("leave")}),$(".J_read").click(function(){$(".J_article").removeClass("leave").addClass("enter")}),$(".J_close_tool").on("click",function(){$(".J_tool_wrap").removeClass("enter").addClass("leave"),$(".J_tool_panpel_btn").removeClass("enter").addClass("leave")}),$(".J_tool_panpel_btn").on("click",function(){$(".J_tool_wrap").removeClass("leave").addClass("enter"),$(".J_tool_panpel_btn").removeClass("leave").addClass("enter")})},J=function(e){var t=$('<div class="msg-content J_msg_content"><p class="J_msg msg">'+e+"</p> </div>");$("body").append(t),setTimeout(function(){t.addClass("enter")},10),setTimeout(function(){t.removeClass("enter"),setTimeout(function(){t.remove()},800)},2e3)},v=function(){$(window).resize(function(){var e=localStorage.fontSize;e&&$("html").css("fontSize",e)})},b=function(){$("#J_copy_code").click(function(){""!=$(this).attr("data-clipboard-text")&&0!=$("#J_code .r-link-block").length||J("至少添加一个跳转链接")})};(function(){var e=document.getElementById("J_main_wrap");$(window).scroll(function(t){e.getBoundingClientRect().top<=-75?$("#J_form_panel").addClass("fixed-form-panel"):$("#J_form_panel").removeClass("fixed-form-panel")})})(),c(),d(),i(),r(function(){o.link=$("#J_link").val(),u(o)}),h(),f(),m(),b(),v()});