$(function(){var t=37.5,e={rotate:0,top:0,left:0,width:75,height:75,borderRadius:0,link:""},n="",o=new Clipboard("#J_copy_code");o.on("success",function(t){p("代码复制成功!!!")}),o.on("error",function(t){p("代码复制失败")});var a=function(t){$("#J_add_link").click(function(){if(""!=n)if("loading"!=n)if("error"!=n){var e=!0;""==$("#J_img_src").val()?(e=!1,$("#J_img_src").addClass("error")):(e=!0,$("#J_img_src").removeClass("error")),""==$("#J_link").val()?(e=!1,$("#J_link").addClass("error")):(e=!0,$("#J_link").removeClass("error")),e&&"function"==typeof t&&t(),""!=$("#J_img_src").val()?""!=$("#J_link").val()||p("请输入跳转链接地址!"):p("请输入图片地址!")}else p("图片加载失败,请重新输入!");else p("图片加载中,请稍后!");else p("请输入图片地址!")}),$("#J_img_src").blur(function(){""==$(this).val()?$(this).addClass("error"):$(this).removeClass("error")}),$("#J_link").blur(function(){""==$(this).val()?$(this).addClass("error"):$(this).removeClass("error")})},i=function(){function t(t){o();var e=new Image(t);e.src=t,e.onload=function(){$(".J_banner").attr("src",t).show()},e.onerror=function(){a("load")}}function e(){n="success",$("#draggable").show(),r(),l(),$("#J_loading_panel").hide(),$(".J_disabled").removeClass("disabled")}function o(){n="loading",$("#J_loading_txt").hide(),$("#J_loading_panel").show(),$(".J_banner").hide(),$(".J_disabled").addClass("disabled"),$("#draggable").hide(),g()}function a(t){g(),n="error",$(".J_banner").hide(),$("#draggable").hide(),$("#J_loading_panel").hide(),"input"==t?(p("请输入正确图片地址!"),$("#J_loading_txt").show().html("请输入正确图片地址!")):(p("图片加载失败!"),$("#J_loading_txt").show().html("图片加载失败!"))}var i=$("#J_img_src").val();$("#J_img_src").blur(function(){var e=$(this).val();e!=i&&(""==e||null==e.match("http")&&null==e.match("https")?a("input"):t(e))}),""!=i&&t(i),$("#J_img_wrap .J_banner").load(function(){e()})},r=function(){$("#draggable").julyuiDrag({isLimit:!0,position:"absolute",scroll:!0,onStop:function(t){$(this).attr("PosX",t.left).attr("PosY",t.top),e.left=t.left,e.top=t.top}})},l=function(){$("#draggable").julyuiDragResize({onStop:function(t){e.left=t.left,e.top=t.top,e.width=t.width,e.height=t.height}})},s=function(){$("input[name=shape]").on("change",function(){var t=$(this).val();e.borderRadius=1==t?0:"50%",$("#draggable").css({borderRadius:e.borderRadius})})},d=function(){$("#rangeRotate").on("change mousemove touchmove",function(){var t=$(this).val();$("#J_rotate").html("("+t+")"),e.rotate=t,$("#draggable").css({transform:"rotate("+t+"deg)"})}),$("#J_reset").click(function(){$("#J_rotate").html("(0)"),e.rotate=0,$("#rangeRotate").val(0),$("#draggable").css({transform:"rotate(0deg)"})})},c=function(e){var n=(e.top/t).toFixed(6),o=(e.left/t).toFixed(6),a=(e.height/t).toFixed(6),i=(e.width/t).toFixed(6),r=(new Date).getTime();return"<a class='r-link-block J_link"+r+"' data-id="+r+" style='display:block;transform:rotate("+e.rotate+"deg);position:absolute;left:"+o+"rem;top:"+n+"rem;width:"+i+"rem;height:"+a+"rem;z-index:2;border-radius:"+e.borderRadius+"' href='"+e.link+"'></a>"},u=function(t){$(".J_banner_link_code").append(c(t)),f()},_=function(){$(document).on("click",".J_banner_link_code .r-link-block",function(t){t.stopPropagation(),t.preventDefault();var e=$(this).data("id");return $(".J_link"+e).remove(),f(),!1})},f=function(){var t=$("#J_code").html();$("#J_copy_code").attr("data-clipboard-text",t)},g=function(){$(".r-link-block").remove(),$("#J_copy_code").attr("data-clipboard-text","")},m=function(){},h=function(){$(".J_app").click(function(){t=$(this).data("size"),$("#J_app_list").addClass("leave")}),$(".J_close").click(function(){$(".J_article").removeClass("enter").addClass("leave")}),$(".J_read").click(function(){$(".J_article").removeClass("leave").addClass("enter")})},p=function(t){var e=$('<div class="msg-content J_msg_content"><p class="J_msg msg">'+t+"</p> </div>");$("body").append(e),setTimeout(function(){e.addClass("enter")},10),setTimeout(function(){e.removeClass("enter"),setTimeout(function(){e.remove()},800)},2e3)},J=function(){$("#J_copy_code").click(function(){""==$(this).attr("data-clipboard-text")&&p("至少添加一个跳转区域")})};(function(){var t=document.getElementById("J_main_wrap");$(window).scroll(function(e){t.getBoundingClientRect().top<=-75?$("#J_form_panel").addClass("fixed-form-panel"):$("#J_form_panel").removeClass("fixed-form-panel")})})(),d(),s(),i(),a(function(){e.link=$("#J_link").val(),u(e)}),m(),_(),h(),J()});